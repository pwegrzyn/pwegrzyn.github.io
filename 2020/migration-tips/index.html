<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><link rel=next href=https://pwegrzyn.github.io/2020/getting-started-with-opengl/><link rel=canonical href=https://pwegrzyn.github.io/2020/migration-tips/><link rel='shortcut icon' type=image/x-icon href=https://pwegrzyn.github.io/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=https://pwegrzyn.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://pwegrzyn.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://pwegrzyn.github.io/favicon-16x16.png><link rel=manifest href=https://pwegrzyn.github.io/site.webmanifest><link rel=mask-icon href=https://pwegrzyn.github.io/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>Software Migration Tips (Python 3 Edition) | Patryk Węgrzyn</title><meta name=title content="Software Migration Tips (Python 3 Edition) | Patryk Węgrzyn"><link rel=stylesheet href=https://pwegrzyn.github.io/font/iconfont.css><link rel=stylesheet href=https://pwegrzyn.github.io/css/main.min.css><meta name=twitter:card content="summary"><meta name=twitter:title content="Software Migration Tips (Python 3 Edition)"><meta name=twitter:description content="In this post I&rsquo;d like to share some tips in regard to migrating a fairly complex software system to a new version of the programming language in which it has been originally written in. Most of the advice will be based on and related to the migration from Python 2 to Python 3 as this is probably the most likely migration process you can encounter in your near-future software career and it also happens to be the process I have the most experience with."><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Software Migration Tips (Python 3 Edition)","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/pwegrzyn.github.io\/2020\/migration-tips\/"},"genre":"posts","wordcount":993,"url":"https:\/\/pwegrzyn.github.io\/2020\/migration-tips\/","datePublished":"2020-09-14T00:00:00\u002b00:00","dateModified":"2020-09-14T00:00:00\u002b00:00","publisher":{"@type":"Organization","name":"pwegrzyn","logo":{"@type":"ImageObject","url":"https:\/\/pwegrzyn.github.io\/images\/profile.png","width":127,"height":40}},"author":{"@type":"Person","name":"pwegrzyn"},"description":""}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=https://pwegrzyn.github.io>Patryk Węgrzyn</a></div><div class="menu navbar-right"><a class=menu-item href=https://pwegrzyn.github.io/posts/ title>Blog</a>
<a class=menu-item href=https://pwegrzyn.github.io/about title>About</a>
<a href=javascript:void(0); class=theme-switch><i class="iconfont icon-sun"></i></a>&nbsp;</div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-sun"></i></a>&nbsp;<a href=https://pwegrzyn.github.io>Patryk Węgrzyn</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=https://pwegrzyn.github.io/posts/ title>Blog</a>
<a class=menu-item href=https://pwegrzyn.github.io/about title>About</a></div></div></nav><main class=main><div class=container><article class=post-warp><header class=post-header><h1 class=post-title>Software Migration Tips (Python 3 Edition)</h1><div class=post-meta>Written by <a href=https://pwegrzyn.github.io rel=author>Patryk Węgrzyn</a> with ♥
<span class=post-time>on <time datetime=2020-09-14>14 September 2020</time></span>
in
<i class="iconfont icon-folder"></i>
<span class=post-category><a href=https://pwegrzyn.github.io/categories/python/>python</a>
<a href=https://pwegrzyn.github.io/categories/software/>software</a></span>
<i class="iconfont icon-timer"></i>
5 min</div></header><div class=post-content><p>In this post I&rsquo;d like to share some tips in regard to migrating a fairly complex software system to a new version
of the programming language in which it has been originally written in. Most of the advice will be based on and related to the migration
from Python 2 to Python 3 as this is probably the most likely migration process you can encounter in your near-future software career and it also happens to be
the process I have the most experience with.</p><p><figure><img src=https://pwegrzyn.github.io/images/ring.svg data-sizes=auto data-src=https://pwegrzyn.github.io/images/spooky.jpg alt="Spooky stuff" class=lazyload><figcaption class=image-caption>Spooky stuff</figcaption></figure></p><h2 id=preparation>Preparation</h2><p>Migration can be a really daunting, complex and filled-with-traps process. Therefore it&rsquo;s crucial to properly prepare for what&rsquo;s to come. You should take some
time to prepare a full plan for the migration process with more-or-less strict deadlines that&rsquo;ll keep you productive and focused on track. Try to read about what
are the most imporant changes between the new and old version. Make sure you understand the mechanisms and ideas behind all implementation details of the legacy version.
Read blogs posts, watch videos and do whatever it takes to learn how to migration process was conducted in other companies/teams and try to reflect it onto your system.</p><h2 id=dont-underestiamte-the-challange>Don&rsquo;t underestiamte the challange</h2><p>You might think that a migration is relatively simple task doable within a couple of days. In some cases, where the system is simple, well structured, non-complex and has lot&rsquo;s
of tests already written that might as well be true. But in general, if the system is more complex and especially if it has some technical debt and/or depends heavily on implementation
details that become fundamentally broken/changed after the migration, you should be allocate at least a couple of months for the migration even have the slightest chance of being successfull. You know, just assume that THERE WILL BE PROBLEMS - there will be situations in which spend hours debugging what&rsquo;s wrong just for it to turn out that the implementation
of a single function for database interactions has introduced a tiny side effect in the new version.</p><h2 id=spend-time-understanding-the-internals>Spend time understanding the internals</h2><p>If the system is complex take, take your time and try to understand most of the critical sub-parts of the system, so that during the migration you already know what can brake and how to fix it. This is especially important if you are a new member in the new, or the team itself got created just for the purpose of migration.</p><h2 id=split-the-process>Split the process</h2><p>In general, be prepared to migrate the system part-by-part, not all at once. Debugging would be a nightmare if you could not trust ANY part of your system. But migration one component
at a time you can steadily progress the process and build on top of already working sub-parts.</p><h2 id=automate-as-much-as-possible>Automate as much as possible</h2><p>Try to use already existing tools which automate the boilerplate parts of the migration. In the case of Python, there are tools like <em>2to3</em> and <em>six</em>, which take care of automatically applying simple syntax changes, standard library module paths, function signatures, etc. I&rsquo;d adivce to split this process and apply these <em>fixers</em> (as they are called) ony by one, since doing it at once can lead to subtle bugs which can be hard to debug later on.</p><h2 id=test-test-test>Test, test, test</h2><p>If your system already has a proper amount of tests then you&rsquo;re in luck. Otherwise a good idea would be to prepare unit tests before the migration process, make them pass on the old oversion and then start the migration but with the requirement that at all time the old unit tests must continue to pass.</p><h2 id=implement-fallback-mechanisms>Implement fallback mechanisms</h2><p>The new version will have bugs, deal with it. Always have available methods to fallback the the old version if things go bad on production. The mechanisms themselves should be well tested and able to swtich the implementation quickly, easily and painlessly.</p><h2 id=be-ready-to-come-up-with-clever-ideas>Be ready to come up with clever ideas</h2><p>The migration might introduce problems which will be highly non-trivial and will require lots of creativity to solve. From experience I can say that if you have some sort of object serialization in your project (using <em>pickle</em> or any other module) in Python 2 and you want to port it to Python 3 (while preserving data compatiblity) then you are pretty much screwed, and getting out of this situation will require lots of creative thinking ;-).</p><h2 id=consider-upgrading-your-dependencies>Consider upgrading your dependencies</h2><p>A migration might be a good time to finnaly update some of you super-old dependencies. This will be a security and maintainability win for all. This decision might as well be forced on you, since the old version of your software may have dependencies to specific version of libraries which are no longer maintained or are not compatible with your new version.</p><h2 id=dont-overestimate-your-ability-to-introduce-massive-refactoring>Don&rsquo;t overestimate your ability to introduce massive refactoring</h2><p>The migration by itself will be a huge undertaking, don&rsquo;t make it harder for yourself and adding massive refactors on top of it. Stuff like adding type-hinting in Python, moving from a custom WSGI application to Django, rewritting logging mechanisms - sure, these all sound nice, but you can always come back to them after the migration is finished.</p><h2 id=bonus-python-2-3-specific-issues>Bonus: Python 2->3 specific issues</h2><p>Here are some the most imporant things to keep in mind when in comes to migrating to Python 3:</p><ul><li>distincation between raw, C-like bytes and decoded strings</li><li>order of dict and set elements is random and you should not depend on it</li><li>syntax changes: handling exception, print-keyword, etc.</li><li><code>.has_key()</code> is replaced by <code>in</code></li><li>modules implemented in C, like cString become the default</li><li>some modules in the standard library are renamed or moved (e.g. httpclient)</li><li><code>psycopg2</code> uses <code>bytearray</code> (not <code>bytes</code>!) as the default type for BYTEA attributes</li><li><code>pickle</code> was massively changed in Python 3 - compatibility with Python 2 is possible but is super tricky</li></ul><h2 id=conclusion>Conclusion</h2><p>That&rsquo;s it for today, thanks for reading. I&rsquo;ll try to update this post if some other tips come to my mind at some point in the future.</p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>Patryk Węgrzyn</span></p><p class=copyright-item><span>Words:</span>
<span>993</span></p><p class=copyright-item><span>Share:</span>
<span><a href="//twitter.com/share?url=https%3a%2f%2fpwegrzyn.github.io%2f2020%2fmigration-tips%2f&text=Software%20Migration%20Tips%20%28Python%203%20Edition%29&via=_pwegrzyn" target=_blank title="Share on Twitter"><i class="iconfont icon-twitter"></i></a>
<a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fpwegrzyn.github.io%2f2020%2fmigration-tips%2f" target=_blank title="Share on Facebook"><i class="iconfont icon-facebook"></i></a>
<a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fpwegrzyn.github.io%2f2020%2fmigration-tips%2f&title=Software%20Migration%20Tips%20%28Python%203%20Edition%29" target=_blank title="Share on LinkedIn"><i class="iconfont icon-linkedin"></i></a></span></p><p class=copyright-item>Released under <a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></p></div><div class=post-tags><section><a href=javascript:window.history.back();>Back</a></span> ·
<span><a href=https://pwegrzyn.github.io>Home</a></span></section></div><div class=post-nav><a href=https://pwegrzyn.github.io/2020/getting-started-with-opengl/ class=next rel=next title="Getting Started with OpenGL in 2020">Getting Started with OpenGL in 2020&nbsp;<i class="iconfont icon-xiaojiantou"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2020 – 2022</span>
<span class=author itemprop=copyrightHolder><a href=https://pwegrzyn.github.io>Patryk Węgrzyn</a></span>
<span></span></div></footer><link crossorigin=anonymous integrity=sha384-yziQACfvCVwLqVFLqkWBYRO3XeA4EqzfXKGwaWnenYn5XzqfJFlFdKEmvutIQdKb href=https://lib.baomitu.com/lightgallery/1.6.12/css/lightgallery.min.css rel=stylesheet><script src=https://pwegrzyn.github.io/js/vendor_gallery.min.js async></script></div></body></html>